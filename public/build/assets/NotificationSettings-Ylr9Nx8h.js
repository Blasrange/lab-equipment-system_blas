import{j as e}from"./ui-Cj8tNzmz.js";import{B as j}from"./badge-Cd2sx6iM.js";import{a as w,c as k,B as n}from"./createLucideIcon-DiPseUVF.js";import{C as c,a as d,b as W,c as Y}from"./card-EpvHltLW.js";import{D as Z,a as ee,b as se,c as te,d as ae}from"./dialog-CBC3IB3i.js";import{I as S}from"./input-C7tlPKmq.js";import{L as N}from"./label-Cy5ruKA9.js";import{u as oe}from"./app-C407sp3e.js";import{A as ie,B as E,S as L}from"./app-layout-jnD-2bHt.js";import{r as m,u as D,H as ne,L as re,a as le}from"./inertia-C4EOeDop.js";import ce from"./NotificationExcelExportModal-mEsQjXOy.js";import{F as de}from"./file-spreadsheet-ASzN2Gt7.js";import{P as me}from"./play-Bshds1vS.js";import{C as M}from"./clock-Dkq7jQFK.js";import{M as H}from"./mail-uYObH4Rx.js";import{C as T}from"./circle-x-CROHQSdY.js";import{C as I}from"./calendar-Lyx_Vy2V.js";import{X as xe}from"./x-CvHTzx3m.js";import"./vendor-Y7T1HomI.js";import"./clsx-B-dksMZM.js";/* empty css            */import"./index-9L3mPNV5.js";import"./use-translation-BK63PS2w.js";import"./app-logo-icon-DR1pHvUL.js";import"./check-CQXnmWxQ.js";import"./Close-N_b2r1ZG.js";import"./download-BIpjet3i.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],B=w("CircleCheck",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],pe=w("History",fe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],be=w("Save",ue);function ge({checked:x=!1,onCheckedChange:r,disabled:s=!1,className:u,...v}){return e.jsx("button",{role:"switch","aria-checked":x,disabled:s,className:k("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",x?"bg-primary":"bg-input",u),onClick:()=>r?.(!x),...v,children:e.jsx("div",{className:k("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",x?"translate-x-5":"translate-x-0")})})}const ve={calibration_due:I,maintenance_reminder:M,maintenance_completed:B,maintenance_overdue:T},ye={calibration_due:"bg-yellow-100 text-yellow-800 border-yellow-200",maintenance_reminder:"bg-blue-100 text-blue-800 border-blue-200",maintenance_completed:"bg-green-100 text-green-800 border-green-200",maintenance_overdue:"bg-red-100 text-red-800 border-red-200"};function ss({settings:x,stats:r}){const{t:s}=oe(),u={calibration_due:s("notifications.types.calibration_due"),maintenance_reminder:s("notifications.types.maintenance_reminder"),maintenance_completed:s("notifications.types.maintenance_completed"),maintenance_overdue:s("notifications.types.maintenance_overdue")},v={calibration_due:s("notifications.descriptions.calibration_due"),maintenance_reminder:s("notifications.descriptions.maintenance_reminder"),maintenance_completed:s("notifications.descriptions.maintenance_completed"),maintenance_overdue:s("notifications.descriptions.maintenance_overdue")},A=[{title:s("notifications.breadcrumb"),href:"/notifications"}],[f,_]=m.useState(null),[O,b]=m.useState(!1),[je,Ne]=m.useState(!1),[we,_e]=m.useState([]),[Ce,ke]=m.useState(!1),[R,y]=m.useState(!1),[z,C]=m.useState(!1),{data:l,setData:h,put:F,processing:$,errors:Se,reset:P}=D({is_active:!1,days_before:0,email_addresses:[]}),{post:U}=D(),q=t=>{_(t),h({is_active:t.is_active,days_before:t.days_before,email_addresses:t.email_addresses||[]}),b(!0)},V=t=>{t.preventDefault(),f&&F(`/notifications/settings/${f.id}`,{onSuccess:()=>{b(!1),P(),_(null)}})},X=()=>{U("/notifications/process")},G=(t,o)=>{const a=[...l.email_addresses];a[t]=o,h("email_addresses",a)},J=()=>{h("email_addresses",[...l.email_addresses,""])},K=t=>{const o=l.email_addresses.filter((a,i)=>i!==t);h("email_addresses",o)},Q=async(t,o)=>{C(!0);try{console.log("Iniciando exportaciÃ³n de notificaciones con fechas:",{startDate:t,endDate:o});const a=await le.post("/notifications/export-excel",{start_date:t,end_date:o},{responseType:"blob",headers:{"Content-Type":"application/json",Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),i=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),g=window.URL.createObjectURL(i),p=document.createElement("a");p.href=g,p.download=`historial_notificaciones_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(g),console.log("ExportaciÃ³n de notificaciones completada exitosamente"),y(!1)}catch(a){console.error("Error detallado al exportar notificaciones:",a);let i=s("notifications.export.error");a.response?(console.error("Respuesta del servidor:",a.response.status,a.response.data),a.response.status===422?i=s("notifications.export.validation_error"):a.response.status===500&&(i=s("notifications.export.server_error"))):a.request&&(console.error("No se recibiÃ³ respuesta del servidor:",a.request),i=s("notifications.export.connection_error")),alert(i)}finally{C(!1)}};return e.jsxs(ie,{breadcrumbs:A,children:[e.jsx(ne,{title:s("notifications.breadcrumb")}),e.jsxs("div",{className:"flex w-full flex-col items-center px-2 py-4 md:px-8 md:py-8",children:[e.jsxs("div",{className:"mb-6 flex w-full items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 shadow-lg shadow-blue-500/30",children:e.jsx(E,{className:"h-6 w-6 text-white"})}),e.jsx("h1",{className:"bg-gradient-to-br from-blue-600 to-blue-800 bg-clip-text text-3xl font-bold text-transparent",children:s("notifications.title")})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(n,{onClick:()=>y(!0),className:"flex items-center gap-2 rounded-xl bg-gradient-to-r from-green-600 to-green-700 px-4 py-2 font-bold text-white shadow-lg transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-green-700 hover:to-green-800 hover:shadow-xl",children:[e.jsx(de,{className:"h-4 w-4"}),s("notifications.export.excel")]}),e.jsx(re,{href:"/notifications/history",children:e.jsxs(n,{className:"flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 font-bold text-white shadow-lg transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-blue-700 hover:to-blue-800 hover:shadow-xl",children:[e.jsx(pe,{className:"h-4 w-4"}),s("notifications.history")]})}),e.jsxs(n,{onClick:X,className:"flex items-center gap-2 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 font-bold text-white shadow-lg transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-blue-700 hover:to-blue-800 hover:shadow-xl",children:[e.jsx(me,{className:"h-4 w-4"}),s("notifications.process_now")]})]})]}),e.jsxs("div",{className:"mb-8 w-full",children:[e.jsxs("h2",{className:"mb-4 text-xl font-bold text-gray-900",children:["ðŸ“Š ",s("notifications.stats.title")]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-5",children:[e.jsx(c,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-blue-500/20",children:e.jsxs(d,{className:"p-4 text-center",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2",children:[e.jsx(L,{className:"h-6 w-6 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s("notifications.stats.total_settings")})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.total_settings})]})}),e.jsx(c,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-green-500/20",children:e.jsxs(d,{className:"p-4 text-center",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2",children:[e.jsx(B,{className:"h-6 w-6 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s("notifications.stats.active_settings")})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.active_settings})]})}),e.jsx(c,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-yellow-500/20",children:e.jsxs(d,{className:"p-4 text-center",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2",children:[e.jsx(M,{className:"h-6 w-6 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s("notifications.stats.pending")})]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:r.pending_notifications})]})}),e.jsx(c,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-blue-500/20",children:e.jsxs(d,{className:"p-4 text-center",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2",children:[e.jsx(H,{className:"h-6 w-6 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s("notifications.stats.sent_today")})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.sent_today})]})}),e.jsx(c,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-red-500/20",children:e.jsxs(d,{className:"p-4 text-center",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2",children:[e.jsx(T,{className:"h-6 w-6 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s("notifications.stats.failed")})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:r.failed_notifications})]})})]})]}),e.jsx("div",{className:"w-full space-y-6",children:e.jsxs(c,{className:"rounded-xl shadow-lg",children:[e.jsx(W,{className:"pb-4",children:e.jsxs(Y,{className:"flex items-center text-xl font-bold text-gray-900",children:[e.jsx(E,{className:"mr-3 h-6 w-6 text-blue-600"}),s("notifications.settings.title")]})}),e.jsx(d,{className:"pt-0",children:e.jsx("div",{className:"space-y-4",children:x.map(t=>{const o=ve[t.name],a=u[t.name],i=v[t.name],g=ye[t.name];return e.jsx(c,{className:"rounded-lg border border-gray-200 transition-all duration-200 hover:shadow-md",children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[o&&e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-50 to-blue-100",children:e.jsx(o,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-1 flex items-center space-x-2",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:a}),e.jsx(j,{variant:"outline",className:`${g} text-xs`,children:t.name}),t.is_active?e.jsx(j,{className:"border-green-200 bg-green-100 text-xs text-green-800",children:s("notifications.settings.active")}):e.jsx(j,{className:"border-gray-200 bg-gray-100 text-xs text-gray-600",children:s("notifications.settings.inactive")})]}),e.jsx("p",{className:"mb-2 text-sm text-gray-600",children:i}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"h-3 w-3"}),t.days_before," ",s("notifications.settings.days_before")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-3 w-3"}),t.email_addresses?.length||0," ",s("notifications.settings.recipients")]})]})]})]}),e.jsxs(n,{onClick:()=>q(t),size:"sm",className:"flex items-center gap-2 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 px-3 py-1.5 font-semibold text-white shadow-md transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-blue-700 hover:to-blue-800 hover:shadow-lg",children:[e.jsx(L,{className:"h-4 w-4"}),s("notifications.settings.configure")]})]})})},t.id)})})})]})}),e.jsx(Z,{open:O,onOpenChange:b,children:e.jsxs(ee,{className:"max-w-md rounded-xl",children:[e.jsxs(se,{children:[e.jsx(te,{className:"text-lg font-bold",children:s("notifications.edit.title")}),e.jsx(ae,{children:f&&e.jsxs(e.Fragment,{children:[s("notifications.edit.description")," ",u[f.name]]})})]}),f&&e.jsxs("form",{onSubmit:V,className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg bg-gray-50 p-4",children:[e.jsx(ge,{checked:l.is_active,onCheckedChange:t=>h("is_active",t),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700"}),e.jsx(N,{className:"font-medium",children:s("notifications.edit.active_notification")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"days_before",className:"text-sm font-medium",children:s("notifications.edit.days_before_label")}),e.jsx(S,{id:"days_before",type:"number",min:"0",max:"365",value:l.days_before,onChange:t=>h("days_before",parseInt(t.target.value)||0),className:"rounded-lg"}),e.jsx("p",{className:"text-sm text-gray-500",children:s("notifications.edit.days_before_help")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-sm font-medium",children:s("notifications.edit.email_addresses")}),e.jsx(n,{type:"button",onClick:J,size:"sm",className:"rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 px-3 py-1.5 font-semibold text-white shadow-md transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-blue-700 hover:to-blue-800 hover:shadow-lg",children:s("notifications.edit.add_email")})]}),e.jsxs("div",{className:"space-y-3",children:[l.email_addresses.map((t,o)=>e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(S,{type:"email",value:t,onChange:a=>G(o,a.target.value),placeholder:s("notifications.edit.email_placeholder"),className:"rounded-lg"}),e.jsx(n,{type:"button",onClick:()=>K(o),size:"sm",className:"rounded-lg bg-gradient-to-r from-red-600 to-red-700 px-3 py-1.5 font-bold text-white shadow-md transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-red-700 hover:to-red-800 hover:shadow-lg",children:"Ã—"})]},o)),l.email_addresses.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:s("notifications.edit.no_emails")})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3 border-t border-gray-200 pt-4",children:[e.jsxs(n,{type:"button",variant:"outline",onClick:()=>b(!1),className:"rounded-xl border-2 border-blue-600 px-6 py-2 font-semibold text-blue-600 shadow-md transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:bg-blue-50 hover:shadow-lg",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),s("notifications.edit.cancel")]}),e.jsxs(n,{type:"submit",disabled:$,className:"min-w-[100px] rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-2 font-bold text-white shadow-md transition-all duration-200 hover:-translate-y-0.5 hover:transform hover:from-blue-700 hover:to-blue-800 hover:shadow-lg disabled:transform-none disabled:opacity-50",children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),s("notifications.edit.save")]})]})]})]})}),e.jsx(ce,{open:R,onClose:()=>y(!1),onExport:Q,loading:z})]})]})}export{ss as default};
