import{j as e}from"./ui-Cj8tNzmz.js";import{B as y}from"./badge-Cd2sx6iM.js";import{a as te,B as d}from"./createLucideIcon-DiPseUVF.js";import{C as R,b as I,c as E,a as q}from"./card-EpvHltLW.js";import{D as se,a as ae,b as ie,c as re,d as ne}from"./dialog-CBC3IB3i.js";import{I as w}from"./input-C7tlPKmq.js";import{L as l}from"./label-Cy5ruKA9.js";import{C as oe,a as le,S as F,b as T,c as z,d as H,e as m}from"./select-BItHG9Zt.js";import{u as ce}from"./app-C407sp3e.js";import{A as de}from"./app-layout-jnD-2bHt.js";import{r as h,u as B,H as me}from"./inertia-C4EOeDop.js";import{M as O}from"./mail-uYObH4Rx.js";import{F as he,S as xe,C as ue}from"./search-Cw2zQYTE.js";import{C as pe}from"./circle-x-CROHQSdY.js";import{C as fe}from"./clock-Dkq7jQFK.js";import{E as ge}from"./eye-D36qsjfq.js";import"./vendor-Y7T1HomI.js";import"./clsx-B-dksMZM.js";import"./x-CvHTzx3m.js";import"./index-C4dpfX4a.js";import"./check-CQXnmWxQ.js";/* empty css            */import"./index-9L3mPNV5.js";import"./use-translation-BK63PS2w.js";import"./app-logo-icon-DR1pHvUL.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],A=te("RotateCcw",ye),je={pending:fe,sent:ue,failed:pe},M={pending:"bg-yellow-100 text-yellow-800 border-yellow-200",sent:"bg-green-100 text-green-800 border-green-200",failed:"bg-red-100 text-red-800 border-red-200"};function Xe({notifications:o,filters:f}){const{t}=ce(),S={calibration_due:t("notifications.types.calibration_due"),maintenance_reminder:t("notifications.types.maintenance_reminder"),maintenance_completed:t("notifications.types.maintenance_completed"),maintenance_overdue:t("notifications.types.maintenance_overdue"),test:t("notifications.history.type.test")},C={pending:t("notifications.history.status.pending"),sent:t("notifications.history.status.sent"),failed:t("notifications.history.status.failed")},k={calibration_due:"bg-yellow-100 text-yellow-800 border-yellow-200",maintenance_reminder:"bg-blue-100 text-blue-800 border-blue-200",maintenance_completed:"bg-green-100 text-green-800 border-green-200",maintenance_overdue:"bg-red-100 text-red-800 border-red-200",test:"bg-purple-100 text-purple-800 border-purple-200"},$=[{title:t("notifications.breadcrumb"),href:"/notifications"},{title:t("notifications.history.breadcrumb"),href:"/notifications/history"}],[n,V]=h.useState(null),[X,j]=h.useState(!1),[N,G]=h.useState(!1),[c,J]=h.useState(o.current_page||1),[u,D]=h.useState(o.per_page||5),[L,K]=h.useState(!0);h.useEffect(()=>{J(o.current_page),D(o.per_page)},[o.current_page,o.per_page]),h.useEffect(()=>{K(!1)},[]);const{data:s,setData:g,get:x,processing:be}=B({search:f.search||"",status:f.status||"all",notification_type:f.notification_type||"all",date_from:f.date_from||"",date_to:f.date_to||""}),{post:Q}=B(),W=(a=!0)=>{const i={};if(s.search&&s.search.trim()&&(i.search=s.search.trim()),s.status&&s.status!=="all"&&(i.status=s.status),s.notification_type&&s.notification_type!=="all"&&(i.notification_type=s.notification_type),s.date_from&&s.date_from.trim()&&(i.date_from=s.date_from),s.date_to&&s.date_to.trim()&&(i.date_to=s.date_to),!a&&c>1&&(i.page=c.toString()),u!==5&&(i.per_page=u.toString()),Object.keys(i).length===0)x("/notifications/history",{preserveState:!0,preserveUrl:!0,replace:!0});else{const r=new URLSearchParams(i).toString();x(`/notifications/history?${r}`,{preserveState:!0,preserveUrl:!0,replace:!0})}};h.useEffect(()=>{if(L)return;const a=setTimeout(()=>{W(!0)},300);return()=>clearTimeout(a)},[s.search,s.status,s.notification_type,s.date_from,s.date_to,u,L]);const b=a=>{if(a<1||a>p)return;const i={};if(s.search&&s.search.trim()&&(i.search=s.search.trim()),s.status&&s.status!=="all"&&(i.status=s.status),s.notification_type&&s.notification_type!=="all"&&(i.notification_type=s.notification_type),s.date_from&&s.date_from.trim()&&(i.date_from=s.date_from),s.date_to&&s.date_to.trim()&&(i.date_to=s.date_to),a>1&&(i.page=a.toString()),u!==5&&(i.per_page=u.toString()),Object.keys(i).length===0)x("/notifications/history",{preserveState:!0,preserveUrl:!0,replace:!0});else{const r=new URLSearchParams(i).toString();x(`/notifications/history?${r}`,{preserveState:!0,preserveUrl:!0,replace:!0})}},Y=a=>{const i=Number(a.target.value);D(i);const r={};if(s.search&&s.search.trim()&&(r.search=s.search),s.status&&s.status!=="all"&&(r.status=s.status),s.notification_type&&s.notification_type!=="all"&&(r.notification_type=s.notification_type),s.date_from&&(r.date_from=s.date_from),s.date_to&&(r.date_to=s.date_to),r.page="1",i!==5&&(r.per_page=i.toString()),Object.keys(r).length===1&&r.page==="1")x("/notifications/history",{preserveState:!0,preserveUrl:!0,replace:!0});else if(Object.keys(r).length===0)x("/notifications/history",{preserveState:!0,preserveUrl:!0,replace:!0});else{r.page==="1"&&delete r.page;const _=new URLSearchParams(r).toString();x(`/notifications/history?${_}`,{preserveState:!0,preserveUrl:!0,replace:!0})}},U=a=>{Q(`/notifications/${a.id}/resend`,{onSuccess:()=>{x("/notifications/history",{preserveState:!0,preserveUrl:!0,replace:!0})}})},Z=a=>{V(a),j(!0)},P=o.total,p=o.last_page,v=a=>{const i=t("language.spanish")==="EspaÃ±ol"?"es-ES":"en-US";return new Date(a).toLocaleString(i,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return e.jsxs(de,{breadcrumbs:$,children:[e.jsx(me,{title:t("notifications.history.title")}),e.jsxs("div",{className:"flex w-full flex-col items-center px-2 py-4 md:px-8 md:py-8",children:[e.jsx("div",{className:"mb-6 flex w-full items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 shadow-lg shadow-blue-500/30",children:e.jsx(O,{className:"h-6 w-6 text-white"})}),e.jsx("h1",{className:"bg-gradient-to-br from-blue-600 to-blue-800 bg-clip-text text-3xl font-bold text-transparent",children:t("notifications.history.title")})]})}),e.jsxs(R,{className:"mb-4 w-full rounded-xl shadow-lg",children:[e.jsx(I,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(E,{className:"flex items-center text-xl font-bold text-gray-900",children:[e.jsx(he,{className:"mr-3 h-6 w-6 text-blue-600"}),t("notifications.history.filters.title")]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>G(!N),className:"flex items-center gap-2 rounded-lg border-blue-300 text-blue-600 hover:border-blue-400 hover:bg-blue-50",children:N?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4"}),t("notifications.history.filters.hide")]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4"}),t("notifications.history.filters.show")]})})]})}),e.jsxs(q,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.search.label")}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),e.jsx(w,{placeholder:t("notifications.history.search.placeholder"),value:s.search||"",onChange:a=>g("search",a.target.value),className:"rounded-lg pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.status.label")}),e.jsxs(F,{value:s.status,onValueChange:a=>g("status",a),children:[e.jsx(T,{className:"rounded-lg",children:e.jsx(z,{placeholder:t("notifications.history.status.all")})}),e.jsxs(H,{children:[e.jsx(m,{value:"all",children:t("notifications.history.status.all")}),e.jsx(m,{value:"pending",children:t("notifications.history.status.pending")}),e.jsx(m,{value:"sent",children:t("notifications.history.status.sent")}),e.jsx(m,{value:"failed",children:t("notifications.history.status.failed")})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.type.label")}),e.jsxs(F,{value:s.notification_type,onValueChange:a=>g("notification_type",a),children:[e.jsx(T,{className:"rounded-lg",children:e.jsx(z,{placeholder:t("notifications.history.type.all")})}),e.jsxs(H,{children:[e.jsx(m,{value:"all",children:t("notifications.history.type.all")}),e.jsx(m,{value:"calibration_due",children:t("notifications.history.type.calibration_due")}),e.jsx(m,{value:"maintenance_reminder",children:t("notifications.history.type.maintenance_reminder")}),e.jsx(m,{value:"maintenance_completed",children:t("notifications.history.type.maintenance_completed")}),e.jsx(m,{value:"maintenance_overdue",children:t("notifications.history.type.maintenance_overdue")})]})]})]})]}),N&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-4 border-t pt-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.date_from")}),e.jsx(w,{type:"date",value:s.date_from,onChange:a=>g("date_from",a.target.value),className:"rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.date_to")}),e.jsx(w,{type:"date",value:s.date_to,onChange:a=>g("date_to",a.target.value),className:"rounded-lg"})]})]})]})]}),e.jsxs(R,{className:"w-full rounded-xl shadow-lg",children:[e.jsx(I,{className:"pb-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(E,{className:"text-xl font-bold text-gray-900",children:[t("notifications.history.count")," (",o.total,")"]})})}),e.jsxs(q,{className:"pt-0",children:[e.jsxs("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.date")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.type")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.equipment")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.subject")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.recipients")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.status")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("notifications.history.table.actions")})]})}),e.jsx("tbody",{children:o.data.map(a=>{const i=je[a.status],r=M[a.status],_=S[a.notification_type]||a.notification_type,ee=k[a.notification_type]||"bg-gray-100 text-gray-800 border-gray-200";return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"text-sm font-medium",children:v(a.created_at)}),a.sent_at&&e.jsxs("div",{className:"text-xs text-gray-500",children:[t("notifications.history.table.sent")," ",v(a.sent_at)]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(y,{variant:"outline",className:ee,children:_})}),e.jsx("td",{className:"px-4 py-3",children:a.equipment?e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:a.equipment.instrument}),e.jsx("div",{className:"text-xs text-gray-500",children:a.equipment.int_code})]}):e.jsx("span",{className:"text-sm text-gray-400",children:t("notifications.history.table.not_available")})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"max-w-[200px] truncate text-sm font-medium",children:a.subject})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-sm",children:[a.recipients.length," ",t("notifications.history.table.recipients_count")]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs(y,{variant:"outline",className:r,children:[e.jsx(i,{className:"mr-1 h-3 w-3"}),C[a.status]]}),a.error_message&&e.jsx("div",{className:"max-w-[200px] truncate text-xs text-red-600",children:a.error_message})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>Z(a),className:"rounded-lg border-blue-200 text-blue-600 hover:bg-blue-50",children:e.jsx(ge,{className:"h-4 w-4"})}),a.status==="failed"&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>U(a),className:"rounded-lg border-green-200 text-green-600 hover:bg-green-50",children:e.jsx(A,{className:"h-4 w-4"})})]})})]},a.id)})})]}),o.data.length===0&&e.jsxs("div",{className:"py-12 text-center text-gray-500",children:[e.jsx(O,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("p",{className:"mt-2 text-lg font-medium",children:t("notifications.history.no_data.title")}),e.jsx("p",{className:"text-sm",children:t("notifications.history.no_data.subtitle")})]})]}),P>u&&e.jsxs("div",{className:"mt-6 flex w-full items-center justify-between px-2",style:{minHeight:40},children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[t("notifications.history.pagination.showing")," ",o.from??0," ",t("notifications.history.pagination.to")," ",o.to??0," ",t("notifications.history.pagination.of")," ",P," ",t("notifications.history.pagination.entries")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>b(1),disabled:c===1,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:"<<"}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>b(c-1),disabled:c===1,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:"<"}),e.jsx("span",{className:"mx-2 min-w-[24px] text-center text-sm font-medium",children:c}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>b(c+1),disabled:c===p||p===0,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:">"}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>b(p),disabled:c===p||p===0,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:">>"}),e.jsx("select",{value:u,onChange:Y,className:"ml-2 rounded-lg border border-gray-300 px-2 py-1 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none",children:[5,10,25,50].map(a=>e.jsx("option",{value:a,children:a},a))})]})]})]})]}),e.jsx(se,{open:X,onOpenChange:j,children:e.jsxs(ae,{className:"max-h-[80vh] max-w-2xl overflow-y-auto rounded-xl",children:[e.jsxs(ie,{children:[e.jsx(re,{className:"text-lg font-bold",children:t("notifications.history.detail.title")}),e.jsx(ne,{children:t("notifications.history.detail.description")})]}),n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.type")}),e.jsx("div",{className:"mt-1",children:e.jsx(y,{variant:"outline",className:k[n.notification_type]||"border-gray-200 bg-gray-100 text-gray-800",children:S[n.notification_type]||n.notification_type})})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.status")}),e.jsx("div",{className:"mt-1",children:e.jsx(y,{variant:"outline",className:M[n.status],children:C[n.status]})})]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.subject")}),e.jsx("div",{className:"mt-1 rounded-lg bg-gray-50 p-3 text-sm font-medium",children:n.subject})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.recipients")}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:n.recipients.map((a,i)=>e.jsx(y,{variant:"outline",className:"border-blue-200 text-blue-700",children:a},i))})]}),e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.message")}),e.jsx("div",{className:"mt-1 max-h-40 overflow-y-auto rounded-lg bg-gray-50 p-3 text-sm whitespace-pre-wrap",children:n.message})]}),n.error_message&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium text-red-600",children:t("notifications.history.detail.error")}),e.jsx("div",{className:"mt-1 rounded-lg border border-red-200 bg-red-50 p-3 text-sm whitespace-pre-wrap text-red-700",children:n.error_message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.created_at")}),e.jsx("div",{className:"mt-1 text-sm font-medium",children:v(n.created_at)})]}),n.sent_at&&e.jsxs("div",{children:[e.jsx(l,{className:"font-medium",children:t("notifications.history.detail.sent_at")}),e.jsx("div",{className:"mt-1 text-sm font-medium",children:v(n.sent_at)})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 border-t border-gray-200 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>j(!1),className:"rounded-lg border-gray-300",children:t("notifications.history.detail.close")}),n.status==="failed"&&e.jsxs(d,{onClick:()=>{U(n),j(!1)},className:"rounded-lg bg-blue-600 hover:bg-blue-700",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),t("notifications.history.detail.resend")]})]})]})]})})]})]})}export{Xe as default};
