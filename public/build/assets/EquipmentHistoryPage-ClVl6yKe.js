import{j as e}from"./ui-Cj8tNzmz.js";import{u as V}from"./use-translation-BK63PS2w.js";import{A as W,W as K,S as z}from"./app-layout-jnD-2bHt.js";import{r as m,u as G,H as J}from"./inertia-C4EOeDop.js";import{B as _}from"./badge-Cd2sx6iM.js";import{a as Q,B as v}from"./createLucideIcon-DiPseUVF.js";import{C as h,a as u,b as D,c as F}from"./card-EpvHltLW.js";import{I as S}from"./input-C7tlPKmq.js";import{L as d}from"./label-Cy5ruKA9.js";import{C as X,a as Y,S as q,b as C,c as k,d as $,e as c}from"./select-BItHG9Zt.js";import{F as Z,S as ee,C as te}from"./search-Cw2zQYTE.js";import{C as re}from"./calendar-Lyx_Vy2V.js";import{C as se}from"./clock-Dkq7jQFK.js";import{P as ae}from"./play-Bshds1vS.js";import"./vendor-Y7T1HomI.js";import"./app-C407sp3e.js";/* empty css            */import"./x-CvHTzx3m.js";import"./index-9L3mPNV5.js";import"./app-logo-icon-DR1pHvUL.js";import"./check-CQXnmWxQ.js";import"./clsx-B-dksMZM.js";import"./index-C4dpfX4a.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ie=Q("TriangleAlert",le),oe=a=>a.toLowerCase().replace(/\s+/g,"_").replace(/[Ã¡Ã Ã¤Ã¢Ã£]/g,"a").replace(/[Ã©Ã¨Ã«Ãª]/g,"e").replace(/[Ã­Ã¬Ã¯Ã®]/g,"i").replace(/[Ã³Ã²Ã¶Ã´Ãµ]/g,"o").replace(/[ÃºÃ¹Ã¼Ã»]/g,"u").replace(/[Ã±]/g,"n"),T=(a,o,x)=>{if(!a)return a;const p=a.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,""),t=`${o}.${p}`,b=x(t);return b!==t?b:a},de=a=>{switch(a){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in_progress":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"scheduled":return"bg-blue-100 text-blue-800 border-blue-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},ce=a=>{switch(a){case"completed":return te;case"in_progress":return ae;case"scheduled":return se;case"cancelled":return ie;default:return z}},ne=a=>{switch(a){case"preventive":return"bg-blue-100 text-blue-800 border-blue-200";case"corrective":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"predictive":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},me=a=>{switch(a){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};function Ae({equipment:a,maintenances:o,filters:x,stats:p}){const{t,language:b}=V(),[xe,he]=m.useState(null),[ue,pe]=m.useState(!1),[w,E]=m.useState(!1),[n,R]=m.useState(o.current_page||1),[g,P]=m.useState(o.per_page||5),[L,A]=m.useState(!0);m.useEffect(()=>{R(o.current_page),P(o.per_page)},[o.current_page,o.per_page]),m.useEffect(()=>{A(!1)},[]);const{data:r,setData:j,get:y,processing:ge}=G({search:x.search||"",status:x.status||"all",category:x.category||"all",priority:x.priority||"all",date_from:x.date_from||"",date_to:x.date_to||""}),U=o.total,f=o.last_page,B=[{title:t("equipment.title"),href:"/equipment"},{title:t("equipment.history.title"),href:`/equipment/${a.id}/history`}],H=(s=!0)=>{const l={};if(r.search&&r.search.trim()&&(l.search=r.search.trim()),r.status&&r.status!=="all"&&(l.status=r.status),r.category&&r.category!=="all"&&(l.category=r.category),r.priority&&r.priority!=="all"&&(l.priority=r.priority),r.date_from&&r.date_from.trim()&&(l.date_from=r.date_from),r.date_to&&r.date_to.trim()&&(l.date_to=r.date_to),!s&&n>1&&(l.page=n.toString()),g!==5&&(l.per_page=g.toString()),Object.keys(l).length===0)y(`/equipment/${a.id}/history`,{preserveState:!0,preserveUrl:!0,replace:!0});else{const i=new URLSearchParams(l).toString();y(`/equipment/${a.id}/history?${i}`,{preserveState:!0,preserveUrl:!0,replace:!0})}};m.useEffect(()=>{if(L)return;const s=setTimeout(()=>{H(!0)},300);return()=>clearTimeout(s)},[r.search,r.status,r.category,r.priority,r.date_from,r.date_to,g,L]);const N=s=>{if(s<1||s>f)return;const l={};if(r.search&&r.search.trim()&&(l.search=r.search.trim()),r.status&&r.status!=="all"&&(l.status=r.status),r.category&&r.category!=="all"&&(l.category=r.category),r.priority&&r.priority!=="all"&&(l.priority=r.priority),r.date_from&&r.date_from.trim()&&(l.date_from=r.date_from),r.date_to&&r.date_to.trim()&&(l.date_to=r.date_to),s>1&&(l.page=s.toString()),g!==5&&(l.per_page=g.toString()),Object.keys(l).length===0)y(`/equipment/${a.id}/history`,{preserveState:!0,preserveUrl:!0,replace:!0});else{const i=new URLSearchParams(l).toString();y(`/equipment/${a.id}/history?${i}`,{preserveState:!0,preserveUrl:!0,replace:!0})}},M=s=>{const l=Number(s.target.value);P(l);const i={};if(r.search&&r.search.trim()&&(i.search=r.search),r.status&&r.status!=="all"&&(i.status=r.status),r.category&&r.category!=="all"&&(i.category=r.category),r.priority&&r.priority!=="all"&&(i.priority=r.priority),r.date_from&&(i.date_from=r.date_from),r.date_to&&(i.date_to=r.date_to),i.page="1",l!==5&&(i.per_page=l.toString()),Object.keys(i).length===1&&i.page==="1")y(`/equipment/${a.id}/history`,{preserveState:!0,preserveUrl:!0,replace:!0});else if(Object.keys(i).length===0)y(`/equipment/${a.id}/history`,{preserveState:!0,preserveUrl:!0,replace:!0});else{i.page==="1"&&delete i.page;const O=new URLSearchParams(i).toString();y(`/equipment/${a.id}/history?${O}`,{preserveState:!0,preserveUrl:!0,replace:!0})}},I=s=>{const l=b==="es"?"es-ES":"en-US";return new Date(s).toLocaleDateString(l,{year:"numeric",month:"short",day:"numeric"})};return e.jsxs(W,{breadcrumbs:B,children:[e.jsx(J,{title:t("equipment.history.title")}),e.jsxs("div",{className:"flex w-full flex-col items-center px-2 py-4 md:px-8 md:py-8",children:[e.jsx(h,{className:"mb-6 w-full rounded-xl shadow-lg",children:e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-br from-blue-500 to-blue-700 shadow-lg shadow-blue-500/30",children:e.jsx(K,{className:"h-6 w-6 text-white"})}),e.jsx("h1",{className:"bg-gradient-to-br from-blue-600 to-blue-800 bg-clip-text text-3xl font-bold text-transparent",children:a.instrument})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx(d,{className:"font-medium text-gray-600",children:t("equipment.history.internal_code")}),e.jsx("p",{className:"text-lg font-semibold",children:a.int_code})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium text-gray-600",children:t("equipment.brand")}),e.jsx("p",{className:"text-lg font-semibold",children:a.brand})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium text-gray-600",children:t("equipment.model")}),e.jsx("p",{className:"text-lg font-semibold",children:a.model})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium text-gray-600",children:t("equipment.status")}),e.jsx(_,{className:a.active?"border-green-200 bg-green-100 text-green-800":"border-red-200 bg-red-100 text-red-800",children:a.active?t("status.active"):t("status.inactive")})]})]})]})}),e.jsxs("div",{className:"mb-4 w-full",children:[e.jsxs("h2",{className:"mb-3 text-xl font-bold text-gray-900",children:["ðŸ“Š ",t("equipment.history.statistics")]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-5",children:[e.jsx(h,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-blue-500/20",children:e.jsxs(u,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-blue-600",children:p.total}),e.jsx(d,{className:"text-xs font-medium text-gray-600",children:t("equipment.history.total")})]})}),e.jsx(h,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-green-500/20",children:e.jsxs(u,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-green-600",children:p.completed}),e.jsx(d,{className:"text-xs font-medium text-gray-600",children:t("equipment.history.completed")})]})}),e.jsx(h,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-yellow-500/20",children:e.jsxs(u,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:p.pending}),e.jsx(d,{className:"text-xs font-medium text-gray-600",children:t("equipment.history.pending")})]})}),e.jsx(h,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-blue-500/20",children:e.jsxs(u,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-blue-600",children:p.preventive}),e.jsx(d,{className:"text-xs font-medium text-gray-600",children:t("equipment.history.preventive")})]})}),e.jsx(h,{className:"rounded-xl shadow-lg transition-all duration-200 hover:translate-y-[-2px] hover:shadow-xl hover:shadow-red-500/20",children:e.jsxs(u,{className:"p-3 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-red-600",children:p.corrective}),e.jsx(d,{className:"text-xs font-medium text-gray-600",children:t("equipment.history.corrective")})]})})]})]}),e.jsxs(h,{className:"mb-4 w-full rounded-xl shadow-lg",children:[e.jsx(D,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(F,{className:"flex items-center text-xl font-bold text-gray-900",children:[e.jsx(Z,{className:"mr-3 h-6 w-6 text-blue-600"}),t("equipment.history.filters")]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>E(!w),className:"flex items-center gap-2 rounded-lg border-blue-300 text-blue-600 hover:border-blue-400 hover:bg-blue-50",children:w?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4"}),t("equipment.history.hide_filters")]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4"}),t("equipment.history.more_filters")]})})]})}),e.jsxs(u,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.history.search")}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),e.jsx(S,{placeholder:t("equipment.history.search_placeholder"),value:r.search||"",onChange:s=>j("search",s.target.value),className:"rounded-lg pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.status")}),e.jsxs(q,{value:r.status,onValueChange:s=>j("status",s),children:[e.jsx(C,{className:"rounded-lg",children:e.jsx(k,{placeholder:t("equipment.history.all_states")})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:t("equipment.history.all_states")}),e.jsx(c,{value:"scheduled",children:t("common.stats.scheduled")}),e.jsx(c,{value:"in_progress",children:t("common.stats.in_progress")}),e.jsx(c,{value:"completed",children:t("common.stats.completed")}),e.jsx(c,{value:"cancelled",children:t("common.stats.cancelled")})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.history.category")}),e.jsxs(q,{value:r.category,onValueChange:s=>j("category",s),children:[e.jsx(C,{className:"rounded-lg",children:e.jsx(k,{placeholder:t("equipment.history.all_categories")})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:t("equipment.history.all_categories")}),e.jsx(c,{value:"preventive",children:t("equipment.history.preventive")}),e.jsx(c,{value:"corrective",children:t("equipment.history.corrective")}),e.jsx(c,{value:"predictive",children:t("equipment.history.predictive")})]})]})]})]}),w&&e.jsxs("div",{className:"mt-6 grid grid-cols-1 gap-4 border-t pt-6 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.history.priorities")}),e.jsxs(q,{value:r.priority,onValueChange:s=>j("priority",s),children:[e.jsx(C,{className:"rounded-lg",children:e.jsx(k,{placeholder:t("equipment.history.all_priorities")})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:t("equipment.history.all_priorities")}),e.jsx(c,{value:"low",children:t("common.priorities.low")}),e.jsx(c,{value:"medium",children:t("common.priorities.medium")}),e.jsx(c,{value:"high",children:t("common.priorities.high")}),e.jsx(c,{value:"critical",children:t("common.priorities.critical")})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.history.from")}),e.jsx(S,{type:"date",value:r.date_from,onChange:s=>j("date_from",s.target.value),className:"rounded-lg"})]}),e.jsxs("div",{children:[e.jsx(d,{className:"font-medium",children:t("equipment.history.to")}),e.jsx(S,{type:"date",value:r.date_to,onChange:s=>j("date_to",s.target.value),className:"rounded-lg"})]})]})]})]}),e.jsxs(h,{className:"w-full rounded-xl shadow-lg",children:[e.jsx(D,{className:"pb-4",children:e.jsxs(F,{className:"text-xl font-bold text-gray-900",children:[t("equipment.history.title")," (",o.total,")"]})}),e.jsxs(u,{className:"pt-0",children:[e.jsxs("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("common.scheduled_date")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.type")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.category")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.status")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.history.priorities")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.responsible")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.description")}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-700",children:t("equipment.history.duration")})]})}),e.jsx("tbody",{children:o.data.map((s,l)=>{const i=ce(s.status);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"mr-2 h-4 w-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:I(s.scheduled_date)}),s.performed_date&&e.jsxs("div",{className:"text-xs text-gray-500",children:[t("common.done"),":"," ",I(s.performed_date)]})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-sm font-medium",children:t(`equipment.history.type_names.${oe(s.maintenance_type_name)}`)||s.maintenance_type_name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_,{variant:"outline",className:ne(s.maintenance_category),children:t(`equipment.history.${s.maintenance_category}`)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(_,{variant:"outline",className:de(s.status),children:[e.jsx(i,{className:"mr-1 h-3 w-3"}),t(`common.stats.${s.status}`)]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(_,{variant:"outline",className:me(s.priority),children:t(`common.priorities.${s.priority}`)})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-sm font-medium",children:s.responsible_person})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"max-w-[250px]",children:[e.jsx("div",{className:"line-clamp-2 text-sm font-medium",children:s.description}),s.work_performed&&e.jsxs("div",{className:"truncate text-xs text-gray-500",children:[t("common.work"),":"," ",T(s.work_performed,"work",t)]}),s.findings&&e.jsxs("div",{className:"truncate text-xs text-gray-500",children:[t("common.findings"),":"," ",T(s.findings,"findings",t)]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:["Est:"," ",s.estimated_duration,"h"]}),s.actual_duration&&e.jsxs("div",{className:"text-xs text-gray-500",children:[t("common.real"),":"," ",s.actual_duration,"h"]})]})})]},s.id)})})]}),o.data.length===0&&e.jsxs("div",{className:"py-12 text-center text-gray-500",children:[e.jsx(z,{className:"mx-auto h-12 w-12 text-gray-300"}),e.jsx("p",{className:"mt-2 text-lg font-medium",children:t("equipment.history.no_records")}),e.jsx("p",{className:"text-sm",children:t("equipment.history.adjust_filters")})]})]}),U>g&&e.jsxs("div",{className:"mt-6 flex w-full items-center justify-between px-2",style:{minHeight:40},children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[t("common.showing")," ",o.from??0," ",t("common.to")," ",o.to??0," ",t("common.of")," ",U," ",t("common.entries")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:"sm",variant:"outline",onClick:()=>N(1),disabled:n===1,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:"<<"}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>N(n-1),disabled:n===1,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:"<"}),e.jsx("span",{className:"mx-2 min-w-[24px] text-center text-sm font-medium",children:n}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>N(n+1),disabled:n===f||f===0,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:">"}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>N(f),disabled:n===f||f===0,className:"rounded-lg border-gray-300 px-3 py-1 text-xs hover:bg-gray-50",children:">>"}),e.jsx("select",{value:g,onChange:M,className:"ml-2 rounded-lg border border-gray-300 px-2 py-1 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none",children:[5,10,25,50].map(s=>e.jsx("option",{value:s,children:s},s))})]})]})]})]})]})]})}export{Ae as default};
